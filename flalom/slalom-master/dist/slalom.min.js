!function(t,i){"object"==typeof exports&&"object"==typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):"object"==typeof exports?exports.Slalom=i():t.Slalom=i()}(this,function(){return function(t){function i(e){if(n[e])return n[e].exports;var r=n[e]={exports:{},id:e,loaded:!1};return t[e].call(r.exports,r,r.exports,i),r.loaded=!0,r.exports}var n={};return i.m=t,i.c=n,i.p="",i(0)}([function(t,i,n){"use strict";var e={MotionContext:n(4),Manipulator:n(2),MotionConstraint:n(3),Box:n(1),Serialization:n(7)};t.exports=e},function(t){"use strict";function i(t){return Math.round(t*e)/e}function n(t){t&&t.style?this._element=t:(this._element=document.createElement("div"),this._element.className="box",t&&(this._element.textContent=t)),this.x=0,this.y=0,this.right=100,this.bottom=100,this.layoutWidth=-1,this.layoutHeight=-1,this._children=[],this.update()}var e=window.devicePixelRatio;n.prototype.element=function(){return this._element},n.prototype.addChild=function(t){this._children.push(t)},n.prototype.update=function(t,n){function e(t){return t.valueOf?t.valueOf():t}for(var r=e(this.x),o=e(this.y),a=e(this.right),s=e(this.bottom),l=Math.max(0,a-r),u=Math.max(0,s-o),c=0;c<this._children.length;c++)this._children[c].update(r,o);t||(t=0),n||(n=0),r-=t,o-=n;var h=1,p=1;if(-1!=this.layoutWidth&&(h=l/this.layoutWidth,l=this.layoutWidth),-1!=this.layoutHeight&&(p=u/this.layoutHeight,u=this.layoutHeight),1==h&&1==p&&(r=i(r),o=i(o),l=i(l),u=i(u)),l!=this._lastWidth&&(this._lastWidth=l,this._element.style.width=l+"px"),u!=this._lastHeight&&(this._lastHeight=u,this._element.style.height=u+"px"),r!=this._lastX||o!=this._lastY){this._lastX=r,this._lastY=o;var d="translate3D("+r+"px, "+o+"px, 0)";(1!=h||1!=p)&&(d+=" scale("+h+", "+p+")"),this._element.style.webkitTransform=d,this._element.style.transform=d}},t.exports=n},function(t){"use strict";function i(t,i){this._variable=t,this._solver=null,this._axis=i,this._context=null,this._motion=null,this._animation=null,this._name="manipulator-"+t.name+"-"+ ++n,this._hitConstraint=null,this._constraintCoefficient=1,this._motionState={editing:!1,dragging:!1,dragStart:0,dragDelta:0,dragTriggerDelta:0,velocityAnimation:null,velocityAnimationPosition:0,velocityAnimationVelocity:0,constraintAnimation:null,constraintAnimationPosition:0,constraintAnimationVelocity:0,constraintAnimationConstraint:null,trialAnimation:!1}}var n=0;i.prototype.onPan=function(t){if("panstart"==t.type){var i="x"==this._axis?t.deltaX:t.deltaY;this._motionContext.stopOthers(this._variable),this._motionState.dragging=!0,this._motionState.dragStart=this._variable.valueOf(),this._motionState.dragDelta=0,this._motionState.dragTriggerDelta=i,this._update()}else if("panmove"==t.type){var i="x"==this._axis?t.deltaX:t.deltaY;this._motionState.dragDelta=i-this._motionState.dragTriggerDelta,this._update()}else if("panend"==t.type){var n=1e3*-("x"==this._axis?t.velocityX:t.velocityY);this._motionState.dragging=!1,this._motionState.trialAnimation=!0,this._motionContext&&this._motionContext.update(),this._createAnimation(n),this._motionState.trialAnimation=!1}},i.prototype._setMotionContext=function(t){this._motionContext=t,this._solver=t.solver(),this._solver.add(new c.StayConstraint(this._variable,c.Strength.medium,0))},i.prototype.name=function(){return this._name},i.prototype.variable=function(){return this._variable},i.prototype.createMotion=function(t,i){var n=new Gravitas.Friction(.001);return n.set(t,i),n},i.prototype._cancelAnimation=function(t){this._motionState[t]&&(this._motionState[t].cancel(),this._motionState[t]=null)},i.prototype._update=function(){function t(){i._motionState.editing||(i._solver.beginEdit(i._variable,c.Strength.strong),i._motionState.editing=!0)}var i=this;if(this._motionState.dragging){this._cancelAnimation("velocityAnimation"),this._cancelAnimation("constraintAnimation"),this._motionState.velocityAnimationVelocity=0,this._motionState.constraintAnimationVelocity=0,t();var n=this._motionState.dragStart+this._motionState.dragDelta;if(this._hitConstraint){this._solver.suggestValue(this._variable,n);var e=this._hitConstraint.delta()/this._constraintCoefficient;n+=e*this._hitConstraint.overdragCoefficient}this._solver.suggestValue(this._variable,n)}else if(this._motionState.constraintAnimation){this._cancelAnimation("velocityAnimation"),t();var n=this._motionState.constraintAnimationPosition;if(this._solver.suggestValue(this._variable,n),!this._motionState.constraintAnimationConstraint.captive&&0==this._motionState.constraintAnimationConstraint.delta()){var r=this._motionState.constraintAnimationVelocity;this._createAnimation(r)}}else if(this._motionState.velocityAnimation){t();var n=this._motionState.velocityAnimationPosition;this._solver.suggestValue(this._variable,n)}else{if(!this._motionState.editing)return;this._solver.endEdit(this._variable),this._motionState.editing=!1,this._motionState.velocityAnimationVelocity=0,this._motionState.constraintAnimationVelocity=0}this._motionContext&&this._motionContext.update()},i.prototype._createAnimation=function(t){if(!this._motionState.dragging){var i=this;if(this._hitConstraint){if(this._motionState.constraintAnimation){if(this._motionState.constraintAnimationConstraint==this._hitConstraint||this._motionState.constraintAnimationConstraint.captive)return;this._cancelAnimation("constraintAnimation")}this._motionState.constraintAnimationConstraint=this._hitConstraint,t=i._motionState.velocityAnimation?i._motionState.velocityAnimationVelocity:t;var n=this._variable.valueOf();if(i._motionState.velocityAnimation)n=i._motionState.velocityAnimation.model.x(60);else if(t){var e=this.createMotion(this._variable.valueOf(),t);n=e.x(60)}var r=this._motionState.dragStart;if(this._variable!=this._hitConstraint.variable){var o=this._variable.valueOf();this._motionState.editing?(this._solver.suggestValue(this._variable,r),this._solver.solve(),r=this._hitConstraint.variable.valueOf(),this._solver.suggestValue(this._variable,n),this._solver.solve(),n=this._hitConstraint.variable.valueOf(),this._solver.suggestValue(this._variable,o),this._solver.solve()):console.warn("not editing; cannot figure out correct start/end positions for motion constraint")}var a=this._hitConstraint.delta(n,r),s=a/this._constraintCoefficient;this._cancelAnimation("constraintAnimation"),this._cancelAnimation("velocityAnimation");var e=this._hitConstraint.createMotion(this._variable.valueOf());return e.setEnd(this._variable.valueOf()+s,t),void(this._motionState.constraintAnimation=Gravitas.createAnimation(e,function(){i._motionState.constraintAnimationPosition=e.x(),i._motionState.constraintAnimationVelocity=e.dx(),i._update(),e.done()&&(i._cancelAnimation("constraintAnimation"),i._motionState.constraintAnimationConstraint=null,i._update())}))}var e=this.createMotion(this._variable.valueOf(),t);e.done()||(this._cancelAnimation("velocityAnimation"),this._cancelAnimation("constraintAnimation"),this._motionState.velocityAnimation=Gravitas.createAnimation(e,function(){i._motionState.velocityAnimationPosition=e.x(),i._motionState.velocityAnimationVelocity=e.dx(),i._update(),e.done()&&(i._cancelAnimation("velocityAnimation"),i._update(),i._hitConstraint&&i._createAnimation(0))}))}},i.prototype.hitConstraint=function(t,i){return t!=this._hitConstraint?(this._hitConstraint=t,this._constraintCoefficient=i,this._motionState.dragging?void this._update():void(this._motionState.trialAnimation||this._createAnimation())):void 0},i.prototype.hitConstraints=function(t){return 0==t.length?(this._hitConstraint=null,void(this._constraintCoefficient=1)):(t.sort(function(t,i){var n=t.motionConstraint,e=i.motionConstraint;return n.overdragCoefficient==e.overdragCoefficient?Math.abs(i.delta)-Math.abs(t.delta):e.overdragCoefficient-n.overdragCoefficient}),void this.hitConstraint(t[0].motionConstraint,t[0].coefficient,t[0].delta))},i.prototype.animating=function(){return this._motionState.dragging?!1:!!this._motionState.velocityAnimation||this._motionState.trialAnimation},i.prototype.editing=function(){return this._motionState.editing},i.prototype.cancelAnimations=function(){this._cancelAnimation("velocityAnimation"),this._cancelAnimation("constraintAnimation"),this._hitConstraint=null,this._update()},t.exports=i},function(t){"use strict";function i(t,i,e,r){if(this.variable=t,this.value=e,"string"==typeof i)switch(i){case"==":this.op=n.equal;break;case">=":this.op=n.greater;break;case"<=":this.op=n.less;break;case"<":this.op=n.l;break;case">":this.op=n.g;break;case"%":this.op=n.modulo;break;case"||":this.op=n.or}else this.op=i;r||(r={}),this.overdragCoefficient=r.hasOwnProperty("overdragCoefficient")?r.overdragCoefficient:.75,this.physicsModel=r.physicsModel,this.captive=r.captive||!1}var n={greater:function(t,i){return t>=i?0:i-t},less:function(t,i){return i>=t?0:i-t},l:function(t,i){return i>t?0:i-t},g:function(t,i){return t>i?0:i-t},equal:function(t,i){return i-t},modulo:function(t,i,n){var e=i*Math.round(n/i);return e-t},adjacentModulo:function(t,i,e,r){if(void 0===r)return n.modulo(t,i,e);var o=Math.round(r/i),a=Math.round(e/i),s=a-o;s&&(s/=Math.abs(s));var l=(o+s)*i;return l-t},or:function(t,i,n){var e=9007199254740991;if(!Array.isArray(i))return 0;for(var r=e,o=n,a=0;a<i.length;a++){var s=Math.abs(i[a]-n);s>r||(r=s,o=i[a])}return o-t}};i.underDamped=function(){return new Gravitas.Spring(1,200,20)},i.criticallyDamped=function(){return new Gravitas.Spring(1,200,Math.sqrt(800))},i.ops=n,i.prototype.delta=function(t,i){return t||(t=this.variable),this.op(this.variable,this.value,t,i)},i.prototype.createMotion=function(t){var i=this.physicsModel?this.physicsModel():new Gravitas.Spring(1,200,20);return i.snap(t),i},t.exports=i},function(t,i,n){"use strict";function e(){this._solver=new r(new c.SimplexSolver),this._boxes=[],this._motionConstraints=[],this._manipulators=[],this._updating=!1}var r=n(6);e.prototype.solver=function(){return this._solver},e.prototype.addBox=function(t){this._boxes.push(t)},e.prototype.boxes=function(){return this._boxes},e.prototype.addMotionConstraint=function(t){return this._motionConstraints.push(t),t},e.prototype.addManipulator=function(t){return this._manipulators.push(t),t._setMotionContext(this),this.update(),t},e.prototype.update=function(){if(!this._updating){this._updating=!0,this._resolveMotionConstraints();for(var t=0;t<this._boxes.length;t++)this._boxes[t].update();this._updating=!1}},e.prototype._coefficient=function(t,i){var n=this._solver.solver(),e=t.variable(),r=n._editVarMap.get(e);if(!r)return 0;var o=r.editMinus,a=n.rows.get(i);return a?a.coefficientFor(o):0},e.prototype._resolveMotionConstraints=function(){function t(t,i,e,r){var o={motionConstraint:i,coefficient:e,delta:r},a=t.name();n.hasOwnProperty(a)?n[a].violations.push(o):n[a]={manipulator:t,violations:[o]}}function i(){for(var t in n){var i=n[t];i.manipulator.hitConstraints(i.violations)}}for(var n={},e=0;e<this._manipulators.length;e++){var r=this._manipulators[e];n[r.name()]={manipulator:r,violations:[]}}for(var e=0;e<this._motionConstraints.length;e++){var o=this._motionConstraints[e],a=o.delta();if(0!=a)for(var s=0;s<this._manipulators.length;s++){var r=this._manipulators[s];if(0!=a){var l=this._coefficient(r,o.variable);0!=l&&t(r,o,l,a)}}}i()},e.prototype.stopOthers=function(t){for(var i=0;i<this._manipulators.length;i++){var n=this._manipulators[i];0!=this._coefficient(n,t)&&n.cancelAnimations()}},t.exports=e},function(t){t.exports=function(){function t(t,i){function n(){this.constructor=t}n.prototype=i.prototype,t.prototype=new n}function i(t,i,n,e,r,o){this.message=t,this.expected=i,this.found=n,this.offset=e,this.line=r,this.column=o,this.name="SyntaxError"}function n(t){function n(i){function n(i,n,e){var r,o;for(r=n;e>r;r++)o=t.charAt(r),"\n"===o?(i.seenCR||i.line++,i.column=1,i.seenCR=!1):"\r"===o||"\u2028"===o||"\u2029"===o?(i.line++,i.column=1,i.seenCR=!0):(i.column++,i.seenCR=!1)}return Sn!==i&&(Sn>i&&(Sn=0,wn={line:1,column:1,seenCR:!1}),n(wn,Sn,i),Sn=i),wn}function e(t){Vn>xn||(xn>Vn&&(Vn=xn,Mn=[]),Mn.push(t))}function r(e,r,o){function a(t){var i=1;for(t.sort(function(t,i){return t.description<i.description?-1:t.description>i.description?1:0});i<t.length;)t[i-1]===t[i]?t.splice(i,1):i++}function s(t,i){function n(t){function i(t){return t.charCodeAt(0).toString(16).toUpperCase()}return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(t){return"\\x0"+i(t)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(t){return"\\x"+i(t)}).replace(/[\u0180-\u0FFF]/g,function(t){return"\\u0"+i(t)}).replace(/[\u1080-\uFFFF]/g,function(t){return"\\u"+i(t)})}var e,r,o,a=new Array(t.length);for(o=0;o<t.length;o++)a[o]=t[o].description;return e=t.length>1?a.slice(0,-1).join(", ")+" or "+a[t.length-1]:a[0],r=i?'"'+n(i)+'"':"end of input","Expected "+e+" but "+r+" found."}var l=n(o),u=o<t.length?t.charAt(o):null;return null!==r&&a(r),new i(null!==e?e:s(r,u),r,u,o,l.line,l.column)}function o(){var t,i,n,e;if(t=xn,i=A(),i!==W){for(n=[],e=a();e!==W;)n.push(e),e=a();n!==W?(e=A(),e!==W?(bn=t,i=L(n),t=i):(xn=t,t=G)):(xn=t,t=G)}else xn=t,t=G;return t}function a(){var t,i,n;return t=xn,i=I(),i!==W?(n=d(),n!==W?(bn=t,i=X(i),t=i):(xn=t,t=G)):(xn=t,t=G),t}function s(){var i;return t.length>xn?(i=t.charAt(xn),xn++):(i=W,0===En&&e(Y)),i}function l(){var i;return z.test(t.charAt(xn))?(i=t.charAt(xn),xn++):(i=W,0===En&&e(Z)),i===W&&(36===t.charCodeAt(xn)?(i=U,xn++):(i=W,0===En&&e($)),i===W&&(95===t.charCodeAt(xn)?(i=Q,xn++):(i=W,0===En&&e(J)))),i}function u(){var i;return i=l(),i===W&&(46===t.charCodeAt(xn)?(i=K,xn++):(i=W,0===En&&e(ti))),i}function c(){var i,n;return En++,ni.test(t.charAt(xn))?(i=t.charAt(xn),xn++):(i=W,0===En&&e(ei)),En--,i===W&&(n=W,0===En&&e(ii)),i}function h(){var i;return ri.test(t.charAt(xn))?(i=t.charAt(xn),xn++):(i=W,0===En&&e(oi)),i}function p(){var i,n;return En++,10===t.charCodeAt(xn)?(i=si,xn++):(i=W,0===En&&e(li)),i===W&&(t.substr(xn,2)===ui?(i=ui,xn+=2):(i=W,0===En&&e(ci)),i===W&&(13===t.charCodeAt(xn)?(i=hi,xn++):(i=W,0===En&&e(pi)),i===W&&(8232===t.charCodeAt(xn)?(i=di,xn++):(i=W,0===En&&e(vi)),i===W&&(8233===t.charCodeAt(xn)?(i=fi,xn++):(i=W,0===En&&e(mi)))))),En--,i===W&&(n=W,0===En&&e(ai)),i}function d(){var i,n,r;return i=xn,n=A(),n!==W?(59===t.charCodeAt(xn)?(r=_i,xn++):(r=W,0===En&&e(gi)),r!==W?(n=[n,r],i=n):(xn=i,i=G)):(xn=i,i=G),i===W&&(i=xn,n=y(),n!==W?(r=p(),r!==W?(n=[n,r],i=n):(xn=i,i=G)):(xn=i,i=G),i===W&&(i=xn,n=A(),n!==W?(r=v(),r!==W?(n=[n,r],i=n):(xn=i,i=G)):(xn=i,i=G))),i}function v(){var i,n;return i=xn,En++,t.length>xn?(n=t.charAt(xn),xn++):(n=W,0===En&&e(Y)),En--,n===W?i=yi:(xn=i,i=G),i}function f(){var t,i;return En++,t=m(),t===W&&(t=g()),En--,t===W&&(i=W,0===En&&e(Ai)),t}function m(){var i,n,r,o,a,l;if(i=xn,t.substr(xn,2)===Ci?(n=Ci,xn+=2):(n=W,0===En&&e(xi)),n!==W){for(r=[],o=xn,a=xn,En++,t.substr(xn,2)===bi?(l=bi,xn+=2):(l=W,0===En&&e(Si)),En--,l===W?a=yi:(xn=a,a=G),a!==W?(l=s(),l!==W?(a=[a,l],o=a):(xn=o,o=G)):(xn=o,o=G);o!==W;)r.push(o),o=xn,a=xn,En++,t.substr(xn,2)===bi?(l=bi,xn+=2):(l=W,0===En&&e(Si)),En--,l===W?a=yi:(xn=a,a=G),a!==W?(l=s(),l!==W?(a=[a,l],o=a):(xn=o,o=G)):(xn=o,o=G);r!==W?(t.substr(xn,2)===bi?(o=bi,xn+=2):(o=W,0===En&&e(Si)),o!==W?(n=[n,r,o],i=n):(xn=i,i=G)):(xn=i,i=G)}else xn=i,i=G;return i}function _(){var i,n,r,o,a,l;if(i=xn,t.substr(xn,2)===Ci?(n=Ci,xn+=2):(n=W,0===En&&e(xi)),n!==W){for(r=[],o=xn,a=xn,En++,t.substr(xn,2)===bi?(l=bi,xn+=2):(l=W,0===En&&e(Si)),l===W&&(l=h()),En--,l===W?a=yi:(xn=a,a=G),a!==W?(l=s(),l!==W?(a=[a,l],o=a):(xn=o,o=G)):(xn=o,o=G);o!==W;)r.push(o),o=xn,a=xn,En++,t.substr(xn,2)===bi?(l=bi,xn+=2):(l=W,0===En&&e(Si)),l===W&&(l=h()),En--,l===W?a=yi:(xn=a,a=G),a!==W?(l=s(),l!==W?(a=[a,l],o=a):(xn=o,o=G)):(xn=o,o=G);r!==W?(t.substr(xn,2)===bi?(o=bi,xn+=2):(o=W,0===En&&e(Si)),o!==W?(n=[n,r,o],i=n):(xn=i,i=G)):(xn=i,i=G)}else xn=i,i=G;return i}function g(){var i,n,r,o,a,l;if(i=xn,t.substr(xn,2)===wi?(n=wi,xn+=2):(n=W,0===En&&e(Vi)),n!==W){for(r=[],o=xn,a=xn,En++,l=h(),En--,l===W?a=yi:(xn=a,a=G),a!==W?(l=s(),l!==W?(a=[a,l],o=a):(xn=o,o=G)):(xn=o,o=G);o!==W;)r.push(o),o=xn,a=xn,En++,l=h(),En--,l===W?a=yi:(xn=a,a=G),a!==W?(l=s(),l!==W?(a=[a,l],o=a):(xn=o,o=G)):(xn=o,o=G);r!==W?(o=h(),o===W&&(o=v()),o!==W?(n=[n,r,o],i=n):(xn=i,i=G)):(xn=i,i=G)}else xn=i,i=G;return i}function y(){var t,i;for(t=[],i=c(),i===W&&(i=_(),i===W&&(i=g()));i!==W;)t.push(i),i=c(),i===W&&(i=_(),i===W&&(i=g()));return t}function A(){var t,i;for(t=[],i=c(),i===W&&(i=p(),i===W&&(i=f()));i!==W;)t.push(i),i=c(),i===W&&(i=p(),i===W&&(i=f()));return t}function C(){var t,i;return t=xn,i=b(),i===W&&(i=x()),i!==W&&(bn=t,i=Mi(i)),t=i}function x(){var i,n,r;if(i=xn,n=[],Ei.test(t.charAt(xn))?(r=t.charAt(xn),xn++):(r=W,0===En&&e(Oi)),r!==W)for(;r!==W;)n.push(r),Ei.test(t.charAt(xn))?(r=t.charAt(xn),xn++):(r=W,0===En&&e(Oi));else n=G;return n!==W&&(bn=i,n=Fi(n)),i=n}function b(){var i,n,r,o,a;return i=xn,n=xn,r=x(),r!==W?(46===t.charCodeAt(xn)?(o=K,xn++):(o=W,0===En&&e(ti)),o!==W?(a=x(),a!==W?(r=[r,o,a],n=r):(xn=n,n=G)):(xn=n,n=G)):(xn=n,n=G),n!==W&&(bn=i,n=Pi(n)),i=n}function S(){var t,i;return En++,t=xn,i=w(),i!==W&&(bn=t,i=qi(i)),t=i,En--,t===W&&(i=W,0===En&&e(Hi)),t}function w(){var t,i,n,r;if(En++,t=xn,i=l(),i!==W){for(n=[],r=u();r!==W;)n.push(r),r=u();n!==W?(bn=t,i=Di(i,n),t=i):(xn=t,t=G)}else xn=t,t=G;return En--,t===W&&(i=W,0===En&&e(Hi)),t}function V(){var i,n,r,o,a,s;return i=xn,n=S(),n!==W&&(bn=i,n=ki(n)),i=n,i===W&&(i=C(),i===W&&(i=xn,40===t.charCodeAt(xn)?(n=Ii,xn++):(n=W,0===En&&e(Ni)),n!==W?(r=A(),r!==W?(o=I(),o!==W?(a=A(),a!==W?(41===t.charCodeAt(xn)?(s=Ti,xn++):(s=W,0===En&&e(Wi)),s!==W?(bn=i,n=X(o),i=n):(xn=i,i=G)):(xn=i,i=G)):(xn=i,i=G)):(xn=i,i=G)):(xn=i,i=G))),i}function M(){var t,i,n,e;return t=V(),t===W&&(t=xn,i=E(),i!==W?(n=A(),n!==W?(e=M(),e!==W?(bn=t,i=ji(i,e),t=i):(xn=t,t=G)):(xn=t,t=G)):(xn=t,t=G)),t}function E(){var i;return 43===t.charCodeAt(xn)?(i=Bi,xn++):(i=W,0===En&&e(Gi)),i===W&&(45===t.charCodeAt(xn)?(i=Li,xn++):(i=W,0===En&&e(Xi)),i===W&&(33===t.charCodeAt(xn)?(i=Yi,xn++):(i=W,0===En&&e(zi)))),i}function O(){var t,i,n,e,r,o,a,s;if(t=xn,i=M(),i!==W){for(n=[],e=xn,r=A(),r!==W?(o=F(),o!==W?(a=A(),a!==W?(s=M(),s!==W?(r=[r,o,a,s],e=r):(xn=e,e=G)):(xn=e,e=G)):(xn=e,e=G)):(xn=e,e=G);e!==W;)n.push(e),e=xn,r=A(),r!==W?(o=F(),o!==W?(a=A(),a!==W?(s=M(),s!==W?(r=[r,o,a,s],e=r):(xn=e,e=G)):(xn=e,e=G)):(xn=e,e=G)):(xn=e,e=G);n!==W?(bn=t,i=Zi(i,n),t=i):(xn=t,t=G)}else xn=t,t=G;return t}function F(){var i;return 42===t.charCodeAt(xn)?(i=Ui,xn++):(i=W,0===En&&e($i)),i===W&&(47===t.charCodeAt(xn)?(i=Qi,xn++):(i=W,0===En&&e(Ji))),i}function P(){var t,i,n,e,r,o,a,s;if(t=xn,i=O(),i!==W){for(n=[],e=xn,r=A(),r!==W?(o=R(),o!==W?(a=A(),a!==W?(s=O(),s!==W?(r=[r,o,a,s],e=r):(xn=e,e=G)):(xn=e,e=G)):(xn=e,e=G)):(xn=e,e=G);e!==W;)n.push(e),e=xn,r=A(),r!==W?(o=R(),o!==W?(a=A(),a!==W?(s=O(),s!==W?(r=[r,o,a,s],e=r):(xn=e,e=G)):(xn=e,e=G)):(xn=e,e=G)):(xn=e,e=G);n!==W?(bn=t,i=Ki(i,n),t=i):(xn=t,t=G)}else xn=t,t=G;return t}function R(){var i;return 43===t.charCodeAt(xn)?(i=Bi,xn++):(i=W,0===En&&e(Gi)),i===W&&(45===t.charCodeAt(xn)?(i=Li,xn++):(i=W,0===En&&e(Xi))),i}function H(){var t,i,n,e,r,o,a,s,l;if(t=xn,i=P(),i!==W){for(n=[],e=xn,r=A(),r!==W?(o=q(),o!==W?(a=A(),a!==W?(s=P(),s!==W?(l=k(),l===W&&(l=Ri),l!==W?(r=[r,o,a,s,l],e=r):(xn=e,e=G)):(xn=e,e=G)):(xn=e,e=G)):(xn=e,e=G)):(xn=e,e=G);e!==W;)n.push(e),e=xn,r=A(),r!==W?(o=q(),o!==W?(a=A(),a!==W?(s=P(),s!==W?(l=k(),l===W&&(l=Ri),l!==W?(r=[r,o,a,s,l],e=r):(xn=e,e=G)):(xn=e,e=G)):(xn=e,e=G)):(xn=e,e=G)):(xn=e,e=G);n!==W?(bn=t,i=tn(i,n),t=i):(xn=t,t=G)}else xn=t,t=G;return t}function q(){var i;return t.substr(xn,2)===nn?(i=nn,xn+=2):(i=W,0===En&&e(en)),i===W&&(t.substr(xn,2)===rn?(i=rn,xn+=2):(i=W,0===En&&e(on)),i===W&&(60===t.charCodeAt(xn)?(i=an,xn++):(i=W,0===En&&e(sn)),i===W&&(62===t.charCodeAt(xn)?(i=ln,xn++):(i=W,0===En&&e(un))))),i}function D(){var i;return t.substr(xn,9)===cn?(i=cn,xn+=9):(i=W,0===En&&e(hn)),i===W&&(t.substr(xn,7)===pn?(i=pn,xn+=7):(i=W,0===En&&e(dn)),i===W&&(t.substr(xn,7)===vn?(i=vn,xn+=7):(i=W,0===En&&e(fn)),i===W&&(t.substr(xn,5)===mn?(i=mn,xn+=5):(i=W,0===En&&e(_n))))),i}function k(){var t,i,n;return t=xn,i=A(),i!==W?(n=D(),n!==W?(bn=t,i=gn(n),t=i):(xn=t,t=G)):(xn=t,t=G),t}function I(){var i,n,r,o,a,s,l,u,c;if(i=xn,n=H(),n!==W){for(r=[],o=xn,a=A(),a!==W?(t.substr(xn,2)===yn?(s=yn,xn+=2):(s=W,0===En&&e(An)),s!==W?(l=A(),l!==W?(u=H(),u!==W?(c=k(),c===W&&(c=Ri),c!==W?(a=[a,s,l,u,c],o=a):(xn=o,o=G)):(xn=o,o=G)):(xn=o,o=G)):(xn=o,o=G)):(xn=o,o=G);o!==W;)r.push(o),o=xn,a=A(),a!==W?(t.substr(xn,2)===yn?(s=yn,xn+=2):(s=W,0===En&&e(An)),s!==W?(l=A(),l!==W?(u=H(),u!==W?(c=k(),c===W&&(c=Ri),c!==W?(a=[a,s,l,u,c],o=a):(xn=o,o=G)):(xn=o,o=G)):(xn=o,o=G)):(xn=o,o=G)):(xn=o,o=G);r!==W?(bn=i,n=Cn(n,r),i=n):(xn=i,i=G)}else xn=i,i=G;return i}var N,T=arguments.length>1?arguments[1]:{},W={},j={start:o},B=o,G=W,L=function(t){return t},X=function(t){return t},Y={type:"any",description:"any character"},z=/^[a-zA-Z]/,Z={type:"class",value:"[a-zA-Z]",description:"[a-zA-Z]"},U="$",$={type:"literal",value:"$",description:'"$"'},Q="_",J={type:"literal",value:"_",description:'"_"'},K=".",ti={type:"literal",value:".",description:'"."'},ii={type:"other",description:"whitespace"},ni=/^[\t\x0B\f \xA0\uFEFF]/,ei={type:"class",value:"[\\t\\x0B\\f \\xA0\\uFEFF]",description:"[\\t\\x0B\\f \\xA0\\uFEFF]"},ri=/^[\n\r\u2028\u2029]/,oi={type:"class",value:"[\\n\\r\\u2028\\u2029]",description:"[\\n\\r\\u2028\\u2029]"},ai={type:"other",description:"end of line"},si="\n",li={type:"literal",value:"\n",description:'"\\n"'},ui="\r\n",ci={type:"literal",value:"\r\n",description:'"\\r\\n"'},hi="\r",pi={type:"literal",value:"\r",description:'"\\r"'},di="\u2028",vi={type:"literal",value:"\u2028",description:'"\\u2028"'},fi="\u2029",mi={type:"literal",value:"\u2029",description:'"\\u2029"'},_i=";",gi={type:"literal",value:";",description:'";"'},yi=void 0,Ai={type:"other",description:"comment"},Ci="/*",xi={type:"literal",value:"/*",description:'"/*"'},bi="*/",Si={type:"literal",value:"*/",description:'"*/"'},wi="//",Vi={type:"literal",value:"//",description:'"//"'},Mi=function(t){return{type:"NumericLiteral",value:t}},Ei=/^[0-9]/,Oi={type:"class",value:"[0-9]",description:"[0-9]"},Fi=function(t){return parseInt(t.join(""))},Pi=function(t){return parseFloat(t.join(""))},Ri=null,Hi={type:"other",description:"identifier"},qi=function(t){return t},Di=function(t,i){return t+i.join("")},ki=function(t){return{type:"Variable",name:t}},Ii="(",Ni={type:"literal",value:"(",description:'"("'},Ti=")",Wi={type:"literal",value:")",description:'")"'},ji=function(t,i){return{type:"UnaryExpression",operator:t,expression:i}},Bi="+",Gi={type:"literal",value:"+",description:'"+"'},Li="-",Xi={type:"literal",value:"-",description:'"-"'},Yi="!",zi={type:"literal",value:"!",description:'"!"'},Zi=function(t,i){for(var n=t,e=0;e<i.length;e++)n={type:"MultiplicativeExpression",operator:i[e][1],left:n,right:i[e][3]};return n},Ui="*",$i={type:"literal",value:"*",description:'"*"'},Qi="/",Ji={type:"literal",value:"/",description:'"/"'},Ki=function(t,i){for(var n=t,e=0;e<i.length;e++)n={type:"AdditiveExpression",operator:i[e][1],left:n,right:i[e][3]};return n},tn=function(t,i){for(var n=t,e=0;e<i.length;e++)n={type:"Inequality",operator:i[e][1],left:n,right:i[e][3],strength:i[e][4]};return n},nn="<=",en={type:"literal",value:"<=",description:'"<="'},rn=">=",on={type:"literal",value:">=",description:'">="'},an="<",sn={type:"literal",value:"<",description:'"<"'},ln=">",un={type:"literal",value:">",description:'">"'},cn="!required",hn={type:"literal",value:"!required",description:'"!required"'},pn="!strong",dn={type:"literal",value:"!strong",description:'"!strong"'},vn="!medium",fn={type:"literal",value:"!medium",description:'"!medium"'},mn="!weak",_n={type:"literal",value:"!weak",description:'"!weak"'},gn=function(t){return t},yn="==",An={type:"literal",value:"==",description:'"=="'},Cn=function(t,i){for(var n=t,e=0;e<i.length;e++)n={type:"Equality",operator:i[e][1],left:n,right:i[e][3],strength:i[e][4]};return n},xn=0,bn=0,Sn=0,wn={line:1,column:1,seenCR:!1},Vn=0,Mn=[],En=0;if("startRule"in T){if(!(T.startRule in j))throw new Error("Can't start parsing from rule \""+T.startRule+'".');B=j[T.startRule]}if(N=B(),N!==W&&xn===t.length)return N;throw N!==W&&xn<t.length&&e({type:"end",description:"end of input"}),r(null,Mn,Vn)}return t(i,Error),{SyntaxError:i,parse:n}}()},function(t){"use strict";function i(t){this._solver=t,this._editing=!1,this._editVars=[],this._priority=0,this.add=this._solver.add.bind(this._solver),this.solve=this._solver.solve.bind(this._solver),this.resolve=this._solver.resolve.bind(this._solver),this.addConstraint=this._solver.addConstraint.bind(this._solver),this.removeConstraint=this._solver.removeConstraint.bind(this._solver)}i.prototype.solver=function(){return this._solver},i.prototype.beginEdit=function(t,i){var n=this._find(t);return-1!=n?(this._editVars[n].count++,void console.log("multiple edit sessions on "+t.name)):(this._editVars.push({edit:t,strength:i,priority:this._priority++,suggest:null,count:1}),void this._reedit())},i.prototype._find=function(t){for(var i=0;i<this._editVars.length;i++)if(this._editVars[i].edit===t)return i;return-1},i.prototype.endEdit=function(t){var i=this._find(t);return-1==i?void console.warn("cannot end edit on variable that is not being edited"):(this._editVars[i].count--,void(0==this._editVars[i].count&&(this._editVars.splice(i,1),this._reedit())))},i.prototype.suggestValue=function(t,i){if(!this._editing)return void console.warn("cannot suggest value when not editing");var n=this._find(t);return-1==n?void console.warn("cannot suggest value for variable that we are not editing"):(this._editVars[n].suggest=i,void this._solver.suggestValue(t,i).resolve())},i.prototype._reedit=function(){if(this._editing&&(this._solver.endEdit(),this._solver.removeAllEditVars()),this._editing=!1,0==this._editVars.length)return void this._solver.resolve();for(var t=0;t<this._editVars.length;t++){var i=this._editVars[t];this._solver.addEditVar(i.edit,i.strength,i.priority)}this._solver.beginEdit();for(var t=0;t<this._editVars.length;t++){var i=this._editVars[t];i.suggest&&this._solver.suggestValue(i.edit,i.suggest)}this._solver.resolve(),this._editing=!0},t.exports=i},function(t,i,n){"use strict";function e(t){this._element=t,this._children=[]}function r(t,i){function n(t,i){if(Array.isArray(t))for(var e=0;e<t.length;e++)n(t[e],i);else{var r=new a(t.textContent?t.textContent:"");i.addChild(r),i.element().appendChild(r.element()),m[t.id]=r,r.element().id=t.id,t.className&&(r.element().className=t.className),t.layoutWidth&&(r.layoutWidth=t.layoutWidth),t.layoutHeight&&(r.layoutHeight=t.layoutHeight),t.children&&n(t.children,r)}}function r(t){function i(t,i){return t.hasOwnProperty(i)&&t[i].isExternal?t[i]:(t[i]=new c.Variable({name:i}),t[i])}if(!t)return void 0;if(_.hasOwnProperty(t))return _[t];if(-1==t.indexOf("."))return _[t]=new c.Variable({name:t}),_[t];var n=t.split(".",2);if(n.length<2||!m.hasOwnProperty(n[0]))return null;var e=m[n[0]];switch(n[1]){case"left":return i(e,"x");case"right":return i(e,"right");case"top":return i(e,"y");case"bottom":return i(e,"bottom")}return null}function h(t){function i(t){if(!t)return c.Strength.medium;switch(t){case"!weak":return c.Strength.weak;case"!medium":return c.Strength.medium;case"!strong":return c.Strength.strong;case"!required":return c.Strength.required}return c.Strength.medium}switch(t.type){case"Inequality":var n="<="==t.operator?c.LEQ:c.GEQ,e=new c.Inequality(h(t.left),n,h(t.right),i(t.strength));return f.addConstraint(e),e;case"Equality":var e=new c.Equation(h(t.left),h(t.right),i(t.strength));return f.addConstraint(e),e;case"MultiplicativeExpression":var e=c.times(h(t.left),h(t.right));return e;case"AdditiveExpression":var o="+"==t.operator?c.plus:c.minus;return o(h(t.left),h(t.right));case"NumericLiteral":return new c.Expression(t.value);case"Variable":return r(t.name);default:console.log("Unhandled expression to parse: "+t.type+" expr: ",t)}}function p(t,i,n,e){function r(t,i,n){t&&t.onPan(n),i&&i.onPan(n)}var o=null,a=null;n&&(o=new l(n,"x")),e&&(a=new l(e,"y"));var s=Hammer.DIRECTION_VERTICAL;n&&e?s=Hammer.DIRECTION_ALL:n&&(s=Hammer.DIRECTION_HORIZONTAL);var u=new Hammer.Manager(i);u.add(new Hammer.Pan({direction:s})),u.on("panstart panmove panend pancancel",r.bind(null,o,a)),o&&t.addManipulator(o),a&&t.addManipulator(a)}var d=new e(i),v=new o,f=v.solver(),m={};n(t.box,d),v.addBox(d);for(var _={},g=0;g<t.constraints.length;g++){var y=u.parse(t.constraints[g]);y.map(h)}for(var g=0;g<t.motionConstraints.length;g++){var A=t.motionConstraints[g];v.addMotionConstraint(Array.isArray(A)?new s(r(A[0]),A[1],A[2],A[3]):new s(r(A.lhs),A.op,A.rhs,A.options))}for(var g=0;g<t.manipulators.length;g++){var C=t.manipulators[g];C.axis&&(C[C.axis]=C.variable),p(v,m[C.box].element(),r(C.x),r(C.y))}return v}var o=n(4),a=n(1),s=n(3),l=n(2),u=n(5);e.prototype.element=function(){return this._element},e.prototype.addChild=function(t){this._children.push(t)},e.prototype.update=function(t,i){for(var n=0;n<this._children.length;n++)this._children[n].update(t,i)},t.exports={assemble:r}}])});